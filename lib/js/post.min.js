"use strict";window.tsfPost=function(){function a(){let a=[...document.getElementsByName("visibility")].filter(a=>a.checked)?.[0]?.value;if("password"===a){const b=document.getElementById("post_password")?.value;b?.length&&"0"===b&&(a="public")}return a}function b(){if(!document.querySelector(".tsf-flex"))return;const a=document.getElementById("tsf-flex-inpost-tabs-wrapper"),b=new Map,c=a=>{const d=a.querySelector(".tsf-flex-nav-tab-inner"),e=a.querySelectorAll(".tsf-flex-nav-name");if(d.clientWidth<=a.clientWidth){if(+(a.dataset.displayedNames||1))return;a.dataset.displayedNames=1,e.forEach(a=>{a.style.display=null,tsfUI.fadeIn(a)})}else{if(!+(a.dataset.displayedNames||1))return;a.dataset.displayedNames=0,e.forEach(a=>{a.style.display="none"})}+a.dataset.displayedNames&&(d.clientWidth>a.clientWidth?(e.forEach(a=>{a.style.display="none"}),a.dataset.displayedNames=0):setTimeout(()=>{cancelAnimationFrame(b.get(a.id)),b.set(a.id,requestAnimationFrame(()=>c(a)))},1e3/144))};window.addEventListener("tsf-flex-resize",d=>{const e=d.detail.target||a;e&&b.set(e.id,requestAnimationFrame(()=>c(e)))});const d=a=>{window.dispatchEvent(new CustomEvent("tsf-flex-resize",{bubbles:!1,cancelable:!1,detail:{target:a}}))};let e={};const f=new ResizeObserver(a=>{for(const b of a){let a=b.target;cancelAnimationFrame(e[a.id]),e[a.id]=requestAnimationFrame(()=>{a.dataset.lastWidth||=0,+a.clientWidth!=+a.dataset.lastWidth&&(a.dataset.lastWidth=a.clientWidth,d(a))})}});a&&f.observe(a),d()}function c(){tsfTabs.initStack("tsfSettings",{tabToggledEvent:new CustomEvent("tsf-flex-tab-toggled"),HTMLClasses:{wrapper:"tsf-flex-nav-tab-wrapper",tabRadio:"tsf-flex-nav-tab-radio",tabLabel:"tsf-flex-nav-tab-label",activeTab:"tsf-flex-tab-active",activeTabContent:"tsf-flex-tab-content-active"},fixHistory:!0})}function d(){const b=document.getElementById("autodescription_noindex");if(!b)return;const c=document.getElementById("autodescription_canonical"),d=1,e=2;let f=0,g="";const h=tsfUtils.debounce(()=>{c&&(g||=c.placeholder,c.placeholder=f&d||f&e?"":g)},50),i=a=>{g=a,h()};document.addEventListener("tsf-updated-block-editor-link",a=>i(a.detail.value));const j=a=>{let c=b.querySelector("[value=\"0\"]"),e="";switch(a){case"password":case"private":e="noindex",f|=d;break;default:case"public":e=b.dataset.defaultUnprotected,f&=~d}c&&(c.innerHTML=b.dataset.defaultI18n.replace("%s",tsf.escapeString(tsf.decodeEntities(e)))),h()};document.addEventListener("tsf-updated-block-editor-visibility",a=>j(a.detail.value)),document.querySelector("#visibility .save-post-visibility")?.addEventListener("click",()=>j(a())),l.states.isPrivate?j("private"):l.states.isProtected?j("password"):j("public");const k=a=>{let c="";switch(+a){case 0:c=b.dataset.defaultUnprotected;break;case-1:c="index";break;case 1:c="noindex"}"noindex"===c?f|=e:f&=~e,h()};b.addEventListener("change",a=>k(a.target.value)),k(b.value)}function e(){const b=document.getElementById(m);if(!b)return;tsfTitle.setInputElement(b);const c=JSON.parse(document.getElementById(`tsf-title-data_${m}`)?.dataset.state||0);c&&(tsfTitle.updateStateOf(m,"allowReferenceChange",!c.refTitleLocked),tsfTitle.updateStateOf(m,"defaultTitle",c.defaultTitle),tsfTitle.updateStateOf(m,"addAdditions",c.addAdditions),tsfTitle.updateStateOf(m,"additionValue",c.additionValue),tsfTitle.updateStateOf(m,"additionPlacement",c.additionPlacement));const d=document.getElementById("autodescription_title_no_blogname");d&&(d.addEventListener("change",a=>{let b=!a.target.checked;l.params.additionsForcedDisabled?b=!1:l.params.additionsForcedEnabled&&(b=!0),tsfTitle.updateStateOf(m,"addAdditions",b)}),d.dispatchEvent(new Event("change")));const e=a=>{let b="";switch(a){case"password":b=tsfTitle.protectedPrefix;break;case"private":b=tsfTitle.privatePrefix;break;default:case"public":b=""}tsfTitle.updateStateOf(m,"prefixValue",b)};document.addEventListener("tsf-updated-block-editor-visibility",a=>e(a.detail.value)),document.querySelector("#visibility .save-post-visibility")?.addEventListener("click",()=>e(a())),l.states.isPrivate?e("private"):l.states.isProtected&&e("password");const f=a=>{a=a?.trim()||"",tsfTitle.updateStateOf(m,"defaultTitle",(tsfTitle.stripTitleTags?tsf.stripTags(a):a)||tsfTitle.untitledTitle)};l.params.isFront||(document.querySelector("#titlewrap #title")?.addEventListener("input",a=>{f(a.target.value)}),document.addEventListener("tsf-updated-block-editor-title",a=>f(a.detail.value))),tsfTitle.enqueueUnregisteredInputTrigger(m)}function f(){const b=document.getElementById(n);if(!b)return;tsfDescription.setInputElement(b);const c=JSON.parse(document.getElementById(`tsf-description-data_${n}`)?.dataset.state||0);c&&(tsfDescription.updateStateOf(n,"allowReferenceChange",!c.refDescriptionLocked),tsfDescription.updateStateOf(n,"defaultDescription",c.defaultDescription.trim())),tsfDescription.enqueueUnregisteredInputTrigger(n);const d=a=>{let b=tsfDescription.getStateOf(n,"useDefaultDescription"),c=!0;switch(a){case"password":case"private":c=!1;break;default:case"public":c=!0}c!==b&&tsfDescription.updateStateOf(n,"useDefaultDescription",c)};document.addEventListener("tsf-updated-block-editor-visibility",a=>d(a.detail.value)),document.querySelector("#visibility .save-post-visibility")?.addEventListener("click",()=>d(a())),l.states.isPrivate?d("private"):l.states.isProtected&&d("password")}function g(){tsfSocial.setInputInstance(o,m,n);const a=JSON.parse(document.getElementById(`tsf-social-data_${o}`)?.dataset.settings||0);a&&(tsfSocial.updateStateOf(o,"addAdditions",a.og.state.addAdditions),tsfSocial.updateStateOf(o,"defaults",{ogTitle:a.og.state.defaultTitle,twTitle:a.tw.state.defaultTitle,ogDesc:a.og.state.defaultDesc,twDesc:a.tw.state.defaultDesc}),tsfSocial.updateStateOf(o,"inputLocks",{ogTitle:a.og.state?.titleLock||!1,twTitle:a.tw.state?.titleLock||!1,ogDesc:a.og.state?.descLock||!1,twDesc:a.tw.state?.descLock||!1}))}function h(){const a=()=>{tsfTitle.enqueueUnregisteredInputTrigger(m),tsfDescription.enqueueUnregisteredInputTrigger(n)};document.getElementById("tsf-flex-inpost-tab-general")?.addEventListener("tsf-flex-tab-toggled",a),window.addEventListener("tsf-flex-resize",a)}function i(){if(!l.states.isGutenbergPage)return;const a=document.querySelector(".tsf-seo-bar"),b=document.querySelector("#tsf-doing-it-right-wrap .tsf-ajax"),c=document.getElementById("autodescription_socialimage-url"),d=tsfSocial.getInputInstance(o)?.inputs?.ogDesc,e=tsfSocial.getInputInstance(o)?.inputs?.twDesc,f={seobar:!!a,metadescription:!!document.getElementById(n),ogdescription:!!d,twdescription:!!e,imageurl:!!c},g=d=>{d=tsf.convertJSONResponse(d);const e=75;setTimeout(()=>{tsfDescription.updateStateOf(n,"defaultDescription",d.data.metadescription.trim());const a=tsfSocial.getStateOf(o,"defaults");a.ogDesc=d.data.ogdescription.trim(),a.twDesc=d.data.twdescription.trim(),tsfSocial.updateStateOf(o,"defaults",a),c&&(c.placeholder=tsf.decodeEntities(d.data.imageurl),c.dispatchEvent(new Event("change")),tsfTT.triggerReset()),tsfAys.reset()},e),a&&tsfUI.fadeOut(a,e,()=>{b&&tsf.unsetAjaxLoader(b,!0),a.innerHTML=d.data.seobar,tsfUI.fadeIn(a,e,()=>{tsfTT.triggerReset()})})},h=()=>{b&&tsf.unsetAjaxLoader(b,!1)};document.addEventListener("tsf-gutenberg-onsave",()=>{b&&tsf.resetAjaxLoader(b),b&&tsf.setAjaxLoader(b),wp.ajax.send("tsf_update_post_data",{data:{nonce:tsf.l10n.nonces.edit_posts,post_id:l.states.id,get:f},timeout:7e3}).done(g).fail(h)})}function j(){d(),e(),f(),g(),h()}function k(){b(),c(),i()}const l="undefined"!=typeof tsfPostL10n&&tsfPostL10n,m="autodescription_title",n="autodescription_description",o="autodescription_social_singular";return Object.assign({load:()=>{document.body.addEventListener("tsf-onload",j),document.body.addEventListener("tsf-ready",k)}},{l10n:l})}(),window.tsfPost.load();
